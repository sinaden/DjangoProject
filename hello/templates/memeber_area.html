{% extends "base.html" %}
<!--{% load static %}-->


 
{% block content %}

<div class="jumbotron text-center">
  <div class="container">
    <!--<a href="/" class="lang-logo">
      <img src="{% static 'lang-logo.png'%}">
    </a>-->
    <h1 style="margin-bottom: 40px;font-size: 45px;">Welcome to dashboard {{name}}</h1>
    
   <!-- <p>Manage datasheets, create new ones, track and edit. </p>-->
    <a type="button" class="btn btn-lg btn-default" href="" data-toggle="modal" data-target="#myModal"><span class="glyphicon glyphicon-plus"></span> Create new repository</a>
    <a type="button" class="btn btn-lg btn-primary" href="/view/"><span class="glyphicon glyphicon-eye-open"></span> View old repos</a>
    <a type="button" class="btn btn-lg btn-info" href="/watch/"><span class="glyphicon glyphicon-search"></span> Watch repos</a>

      <!-- Modal -->
      <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="myModalLabel">Name the new repository.</h4>
            </div>
            <div class="modal-body">
              {% csrf_token %}
              <input type="text" id="repo_name" name="repo_name" class="form-control" style="max-width: 300px;" placeholder="Type your project's title"> <br>
              <span id="validationMessage" style="display: none; color: rgb(218, 0, 0);">Name already exists</span>
              
              <div class="alert alert-danger" role="alert"  style="display: none">
                Name already exists
              </div>
               
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" id="saveModal">Save changes</button>
            </div>
          </div>
        </div>
      </div>


  </div>
</div>
<div class="container">
  <div class="alert alert-light text-center" role="alert">
    To deploy your own copy, and learn the fundamentals of the Heroku platform, head over to the <a href="https://devcenter.heroku.com/articles/getting-started-with-python" class="alert-link">Getting Started with Python on Heroku</a> tutorial.
  </div>
  <hr>
  <div class="row">
    <div class="col-md-4">
      <h3><span class="glyphicon glyphicon-cloud"></span> How this sample app works</h3>
      <ul>
        <li>This app was deployed to Heroku, either using Git or by using <a href="https://github.com/heroku/python-getting-started">Heroku Button</a> on the repository.</li>

        <li>When Heroku received the source code, it fetched all the dependencies in <a href="https://github.com/heroku/python-getting-started/blob/main/requirements.txt">requirements.txt</a>, creating a deployable slug.</li>
        <li>The platform then spins up a dyno, a lightweight container that provides an isolated environment in which the slug can be mounted and executed.</li>
        <li>You can scale your app, manage it, and deploy over <a href="https://addons.heroku.com/">150 add-on services</a>, from the Dashboard or CLI.</li>
      </ul>
    </div>
    <div class="col-md-4">
      <h3><span class="glyphicon glyphicon-education"></span> Next Steps</h3>
      <ul>
        <li>If you are following the <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting Started</a> guide, then please head back to the tutorial and follow the next steps!</li>
        <li>If you deployed this app by deploying the Heroku Button, then in a command line shell, run:</li>
        <ul>
          <li><code>git clone https://github.com/heroku/python-getting-started.git</code> - this will create a local copy of the source code for the app</li>
          <li><code>cd python-getting-started</code> - change directory into the local source code repository</li>
          <li><code>heroku git:remote -a &lt;your-app-name></code> - associate the Heroku app with the repository</li>
          <li>You'll now be set up to run the app locally, or <a href="https://devcenter.heroku.com/articles/getting-started-with-python#push-local-changes">deploy changes</a> to Heroku</li>
        </ul>
      </ul>
      
    </div>

    <div class="col-md-4">
        <h3><span class="glyphicon glyphicon-erase"></span> Helpful Links</h3>
      <ul>
        <li><a href="https://www.heroku.com/home">Heroku</a></li>
        <li><a href="https://devcenter.heroku.com/">Heroku Dev Center</a></li>
        <li><a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting Started with Python on Heroku</a></li>
        <li><a href="https://devcenter.heroku.com/articles/django-app-configuration">Configuring Django Apps for Heroku</a></li>
      </ul>
    </div>

  </div> <!-- row -->
   <div class="alert alert-light text-center" role="alert">
    Please do work through the Getting Started guide, even if you do know how to build such an application.  The guide covers the basics of working with Heroku, and will familiarize you with all the concepts you need in order to build and deploy your own apps.
  </div>
  <!-- Button trigger modal 
  <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
    Launch demo modal
  </button>-->



</div>

<script type="text/javascript">
  $('#myModal').on('hidden.bs.modal', function () {
      // do somethingâ€¦
      $('.alert').hide();
      $("#repo_name").val(''); 
  });
  $("#saveModal").click(function(event){
    console.log(event);
    console.log($("#repo_name").val());
    repo_name_var = $("#repo_name").val();
    $.ajax({
        url: "/check-repo-name/",
        type: 'POST',
        data: {
            repo_name : $("#repo_name").val(),
            csrfmiddlewaretoken:  $('input[name=csrfmiddlewaretoken]').val()
        },
        success: function(data) {
          console.log("success"); 
          if (data.message === "Repo already exists") {
             $('.alert').show();
             window.location = '/new/'+repo_name_var;
          }else{
             $('.alert').hide();
          }
          console.dir(data);
          console.log(data)
          }
    })


  });
    
  $(document).ready(function() {
    $('.alert').hide();
     // autosize(document.getElementById("id_motivation_1"));
      //alert("fff");

  });

</script>
{% endblock %}
